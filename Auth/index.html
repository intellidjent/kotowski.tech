
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Ruslan Katouski">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.ico">
      
      <meta name="generator" content="mkdocs+mkdocs-material#1.0.3">
    
    
      
        <title>Implemention - Tech Docs</title>
      
    
    
      <script src="../assets/javascripts/modernizr-facb31f4a3.js"></script>
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700|Menlo">
        <style>body,input{font-family:"Lato","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Menlo","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-f3ab63f78a.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02ce7adcc2.palette.css">
      
      
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="blue-grey" data-md-color-accent="blue-grey">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Tech Docs" class=" md-icon md-icon--home  md-header-nav__button">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Authentication
                </span>
              
            
            Implemention
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
              


  


  <a href="https://stash.wargaming.net/projects/NGI" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      View Source
    </div>
  </a>

            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-icon md-icon--home  md-nav__button">
      
    </i>
    Tech Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://stash.wargaming.net/projects/NGI" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      View Source
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item">
    
      <a href=".." title="Home" class="md-nav__link">
        Home
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Authentication
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-2">
        Authentication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Implemention
      </label>
    
    <a href="./" title="Implemention" class="md-nav__link md-nav__link--active">
      Implemention
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wgni-api-gateway-method" title="WGNI &amp; API Gateway Method" class="md-nav__link">
    WGNI &amp; API Gateway Method
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-via-wgni-and-api-gateway-auth-token" title="Login via WGNI and API Gateway. Auth Token" class="md-nav__link">
    Login via WGNI and API Gateway. Auth Token
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-auth-token-via-wgni" title="Getting Auth Token via WGNI" class="md-nav__link">
    Getting Auth Token via WGNI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-requests" title="API Requests" class="md-nav__link">
    API Requests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#login-via-api-gateway-remember-me-token" title="Login via API Gateway. Remember Me Token" class="md-nav__link">
    Login via API Gateway. Remember Me Token
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-requests_1" title="API Requests" class="md-nav__link">
    API Requests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../Auth_APIs/" title="Auth APIs" class="md-nav__link">
        Auth APIs
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../Server_APIs/" title="Server APIs" class="md-nav__link">
        Server APIs
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wgni-api-gateway-method" title="WGNI &amp; API Gateway Method" class="md-nav__link">
    WGNI &amp; API Gateway Method
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-via-wgni-and-api-gateway-auth-token" title="Login via WGNI and API Gateway. Auth Token" class="md-nav__link">
    Login via WGNI and API Gateway. Auth Token
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-auth-token-via-wgni" title="Getting Auth Token via WGNI" class="md-nav__link">
    Getting Auth Token via WGNI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-requests" title="API Requests" class="md-nav__link">
    API Requests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#login-via-api-gateway-remember-me-token" title="Login via API Gateway. Remember Me Token" class="md-nav__link">
    Login via API Gateway. Remember Me Token
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-requests_1" title="API Requests" class="md-nav__link">
    API Requests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
              
                
                <h1 id="implementing-authentication">Implementing Authentication</h1>
<p>Before a player can perform any actions they need to authenticate with the Platform. This document describes the login sequence to authenticate a player with the Platform, and contains a description of how to:</p>
<ul>
<li>Create an authenticated session.</li>
<li>Validate this session.</li>
<li>Get inventory data.</li>
<li>Create Auth Token and Remember Me Token.</li>
</ul>
<p>Any API request is signed with an API Key, which is provided during the title registration in the Game Management Tool. Contact the Platform Team to obtain the API Key.</p>
<!-- To proceed, select the suitable authentication method below.

- **Wargaming Game Center**
- **WGNI & API Gateway**
- **Excalibur**

##Wargaming Game Center

This method is not a working solution and is presented for information purposes only.

The following diagram describes the possible flow for authentication via WGC.

![](Login via WGC.png)

Wargaming Game Center (WGC) serves the front-end to all the games and is the only point responsible for authentication.

1. WGC hands off the Auth Token to the Game Client.
2. The Game Client verifies the Auth Token.
3. WGC provides the Game Client with a `new_session_token`.
4. Game Client passes the `new_session_token` to the Game Server.
5. WGC makes a **`getFullInventoryFromSession`** batch request to the Server Gateway passing the `session_token`.
6. The Server Gateway performs a set of requests to get currency balances and entitlements and passes them back to the Game Server.
 -->

<h2 id="wgni-api-gateway-method">WGNI &amp; API Gateway Method</h2>
<p>At this stage 3PP games use a hybrid authentication model via WGNI and API Gateway described below.</p>
<p>Assuming that the Partner Team has the API Key, the following sequence takes place:</p>
<ol>
<li>Login via WGNI and API Gateway using Auth Token for the first login.</li>
<li>Login via API Gateway using Remember Me Token for all subsequent login instances.</li>
</ol>
<p>Each title version has a specific API key to ensure version distinction.</p>
<h3 id="login-via-wgni-and-api-gateway-auth-token">Login via WGNI and API Gateway. Auth Token</h3>
<p>The diagram below describes the initial login process:</p>
<ul>
<li>Get Auth Token via WGNI.</li>
<li>Authenticate and validate session in the Platform.</li>
<li>Get/sync account inventory data.</li>
<li>(Optional) Get Remember Me Token.</li>
<li>(Optional) Get additional Auth Token for XMPPCS.</li>
</ul>
<p><img alt="" src="../assets/token1.png" /></p>
<h4 id="getting-auth-token-via-wgni">Getting Auth Token via WGNI</h4>
<p>Authentication via WGNI is a two-step procedure:</p>
<ol>
<li>Client starts a built-in HTTP-server and opens WGNI page in a system web-browser.</li>
<li>Client receives a request to a built-in web-server from WGNI, which includes authentication credentials (<code>wgid</code> and <code>auth_token</code>).</li>
</ol>
<p><strong>Note:</strong>
The attached Python file is a reference for WGNI implemention. Request the latest version of the file and valid <code>WGNI_URL</code> and <code>SPA_URL</code> from the Platform Team.</p>
<p><code>WGNI_URL</code> — link to a web authentication page where a user logs in.<br />
<code>SPA_URL</code> — S2S back-end API where server requests are sent to.</p>
<h4 id="api-requests">API Requests</h4>
<p>The following requests are used to authenticate a player and synchronize the catalog.</p>
<table>
<thead>
<tr>
<th align="left"><strong>Method</strong></th>
<th align="left"><strong>Gateway</strong></th>
<th align="left"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>loginWithAuthToken</code></td>
<td align="left">Auth</td>
<td align="left">Creates an authenticated session for the user from an Auth Token.</td>
</tr>
<tr>
<td align="left"><code>validateClientSession</code></td>
<td align="left">Server</td>
<td align="left">Returns the <code>profile_id</code> associated with the <code>client_session</code> token.</td>
</tr>
<tr>
<td align="left"><code>getFullInventory</code></td>
<td align="left">Server</td>
<td align="left">Gets profile's and its children's entitlements and virtual currency balances.</td>
</tr>
<tr>
<td align="left"><code>getFullInventoryFromSession</code></td>
<td align="left">Server</td>
<td align="left">Batch operation combining <code>validateClientSession</code> and <code>getFullInventory</code>.</td>
</tr>
<tr>
<td align="left"><code>getPurchaseStatusByOrderId</code></td>
<td align="left">Server</td>
<td align="left">Gets status of a purchase by Order Id.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="login-via-api-gateway-remember-me-token">Login via API Gateway. Remember Me Token</h3>
<p>The diagram below describes a login sequence with Remember Me Token from <code>loginWithAuthToken</code>.</p>
<p><img alt="" src="../assets/token2.png" /></p>
<h4 id="api-requests_1">API Requests</h4>
<p>The following request is used to authenticate a player with a Remember Me Token.</p>
<table>
<thead>
<tr>
<th align="left"><strong>Method</strong></th>
<th align="left"><strong>Gateway</strong></th>
<th align="left"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>loginWithRememberMe</code></td>
<td align="left">Auth</td>
<td align="left">Creates an authenticated session from a Remember Me Token.</td>
</tr>
</tbody>
</table>
<!-- ##Excalibur

Ruslan Katouski > Authenticate Player > Excalibur Auth.pngRuslan Katouski > Authenticate Player > attach-icon.png -->
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../Auth_APIs/" title="Auth APIs" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Auth APIs
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Wargaming.net
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-2afe21e0b2.js"></script>
      <script>var config={url:{base:".."}},app=new Application(config);app.initialize()</script>
      
    
    
      
    
  </body>
</html>